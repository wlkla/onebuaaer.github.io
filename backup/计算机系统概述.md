# 第一章：计算机系统概述

## 计算机发展历程

### 计算机硬件的发展

1. 计算机的四代发展：
   电子管时代 $\longrightarrow$ 晶体管时代 $\longrightarrow$ 中小规模集成电路时代 $\longrightarrow$ 超大规模集成电路时代

## 计算机系统层次结构

### 计算机系统的组成

1. 计算机系统包含硬件系统与软件系统。
2. 对某一功能来说，若其既可以用软件实现，又可以用硬件实现，则称为`软/硬件在逻辑功能上是等价的`。

### 计算机硬件

1. 冯·诺依曼机基本思想

   1)采用“`存储程序`”的工作方式。

   2)计算机硬件系统由`运算器`、`存储器`、`控制器`、`输入设备`与`输出设备`五部分组成。

   3)指令和数据以`同等地位`存储在存储器上，形式上没有区别，但计算机能区分它们。

   4)指令和数据均用二进制代码表示。

   5)指令由操作码和地址码组成，操作码指出操作的类型，地址码指出操作数的地址。

2. 计算机的功能部件

   1)输入设备：

   主要功能：将程序和数据以计算机所能识别和接受的信息形式输入计算机。
   2)输出设备：

   功能：将计算机处理的结果以人们所能接受的形式或其它系统所要求的信息形式输出。
   3)存储器：

   - 存储器分为`主存储器`(内存储器、主存)和`辅助存储器`(外存储器、外存)。
   - CPU能够直接访问的存储器是主存储器。
   - 辅助存储器中的信息必须调入主存储器后才能被CPU访问。
   - 主存储器的工作方式是按存储单元的地址进行存取，这种存储方式称为`按地址存取方式`。
   - 主存储器分为地址寄存器、存储体和数据寄存器。
   - 存储体存放二进制信息，`存储器地址寄存器`(MAR)存放访存地址，经过地址译码后找到所选的存储单元。`存储器数据寄存器`(MDR)用于暂存要从存储器中读或写的信息，时序控制逻辑用于产生存储器操作所需的各种时序信号。
   - 存储体有许多`存储单元`组成，每个存储单元包含若干`存储元件`，每个存储元件存储一位二进制代码。因此存储单元可存储一串二进制代码，称这串代码为`存储字`，称这串代码的位数为`存储字长`。存储字长可以是1B或是字节的偶数倍。
   - MAR用于寻址，其位数反应最多可寻址的存储单元的个数。
   - MDR的位数通常等于存储字长，一般为字节的2次幂的整数倍。

   4)运算器：
   
   - 运算器是计算机的执行部件，用于算术运算和逻辑运算。
   - 运算器的核心是`算术逻辑单元`(ALU)。
   - 必备的三个寄存器：累加器(ACC)，乘商寄存器(MQ)，操作数寄存器(X)。
   - 运算器内还有程序状态寄存器(PSW)，也称为标志寄存器。
   
   5)控制器：
   
   - 控制器由程序计数器(PC)，指令寄存器(IR)和控制单元(CU)组成。
   - PC用来存放当前指令，具有自动`+1`的功能，它与主存储器的MAR之间有一条直接通路。
   - IR用来`存放当前指令`，其内容来自主存储器的MDR。指令中的操作码OP(IR)送至CU，用于分析指令并发出各种微操作命令序列；地址码Ad(IR)送往MAR，用于取操作数。
   - CPU：中央处理器，包含运算器和控制器。
   - CPU和主存储器共同构成主机，除主机外的其他硬件装置统称为外部设备。

### 计算机软件

1. 软件按其功能分类可分为`系统软件`和`应用软件`。

2. 三个级别的语言：
   1)机器语言：是计算机唯一可以直接识别和执行的语言。

   2)汇编语言：使用汇编语言编辑的程序，必须经过一个称为`汇编程序`的系统软件的翻译，将其转化为机器语言程序后，才能在计算机的硬件系统上执行。

   3)高级语言：通常高级语言需要经过`编译程序`编译成汇编语言程序，然后经过`汇编`操作的到机器语言程序，或直接由高级语言程序翻译成机器语言程序。
   高级语言$\stackrel{编译}{\longrightarrow}$汇编语言$\stackrel{汇编}{\longrightarrow}$机器语言；
   高级语言$\stackrel{编译}{\longrightarrow}$机器语言。

3. 翻译程序：
   1)汇编程序(汇编器)：汇编语言程序$\longrightarrow$机器语言

   2)解释程序(解释器)：将源程序中的语句按执行顺序逐条翻译成机器指令并执行。

   3)编译程序(编译器)：高级语言程序$\longrightarrow$汇编语言程序/机器语言程序

### 计算机的层次结构

1. 计算机的五个层次：

   - 第一级是`微程序机器层(M0)`：由机器硬件直接执行微指令。
   - 第二级是`传统机器语言层(M1)`：由微程序解释机器指令系统。

   ---

   - 第三级是`操作系统层(M2)`：操作系统程序是由`机器指令`和`广义指令`组成的，所以这一层也被称为`混合层`。
   - 第四级是`汇编语言层(M3)`。
   - 第五级是`高级语言层(M4)`。

2. 没有配备软件的纯硬件系统称为`裸机`。

3. 第3~5层称为虚拟机，简单来说就是软件实现的机器。

4. 软件和硬件之间的界面就是`指令集体系结构`(ISA)，定义了一台计算机可以执行的所有指令的集合，每条指令规定了计算机执行什么操作，以及所处理的操作数存放的地址空间和操作数类型。

5. ISA是指软件能感知到的部分，也称`软件可见部分`。

### 计算机系统的工作原理

1. 每条指令的执行过程包括：
   主存储器中取指令$\longrightarrow$对指令进行译码$\longrightarrow$计算下条指令地址$\longrightarrow$取操作数并执行$\longrightarrow$将结果送回存储器

2. 若当前指令为`顺序型指令`，则下条指令地址为PC的内容加上当前指令的长度；若当前指令为`转跳型指令`，则下条指令地址为指令中指定的目标地址。

3. 从源程序到可执行文件(以hello.c文件为例)
   hello.c$\stackrel{预处理}{\longrightarrow}$hello.i$\stackrel{编译}{\longrightarrow}$hello.s$\stackrel{汇编}{\longrightarrow}$hello.o$\stackrel{链接}{\longrightarrow}$hello.exe
   1)预处理阶段：`预处理器`对源程序中以#开头的命令进行处理，即将引用的文件插入程序文件。

   2)编译阶段：`编译器`对预处理后的原程序进行编译，生成一个汇编语言源程序。

   3)汇编阶段：`汇编器`将汇编语言程序翻译成机器语言指令，并将这些指令打包成一个称为`可重定位目标文件`。

   4)链接阶段：`链接器`将多个可重定位目标文件和标准库函数合并为一个可执行文件。

### 错题

1. 以下说法错误的是(  )
   A. 硬盘是外部设备

   B. 软件的功能与硬件的功能在逻辑上是等价的

   C. 硬件实现的功能一般比软件实现具有更高的执行速度

   D. 软件的功能不能用硬件取代

2. CPU不包括(  )
   A. 地址寄存器

   B. 指令寄存器

   C. 地址译码器

   D. 通用寄存器

3. 下列关于CPU存取速度的比较中，正确的是(  )

   A. Cache > 内存 > 寄存器

   B. Cache > 寄存器 > 内存

   C. 寄存器 > Cache > 内存

   D. 寄存器 > 内存 > Cache

4. 关于相联存储器，下列说法中正确的是(  )

   A. 只可以按地址寻址

   B. 只可以按内容寻址

   C. 既可以按地址寻址又可以按内容寻址

   D. 以上说法均不完善

5. 将高级语言源程序转化为机器级目标代码文件的程序是(  )

   A. 汇编程序

   B. 链接程序

   C. 编译程序

   D. 解释程序

## 计算机的性能指标

### 计算机的主要性能指标

1. 字长：计算机进行一次`整数运算`所能处理的二进制数据的位数，通常与CPU的寄存器位数、ALU有关。

   字长一般等于通用寄存器的位数或ALU的宽度，字长越长，数的表示范围越大，计算精度越高。

2. 数据通路带宽：是指数据总线一次所能并行传送信息的位数。

3. 主存容量：是指主存储器所能存储信息的最大容量，通常以字节来衡量，也可以用`字数×字长`来表示。

   MAR的位数反映了储存单元的个数，MDR反映了存储单元的字长。

4. 运算速度：

   1)吞吐量：指系统在单位时间内处理请求的数量，主要取决于主存储器的存取周期。

   2)响应时间：指从用户像计算机发送一个请求到系统对该请求做出响应所需要的等待时间。通常包括CPU时间与等待时间。

   3)CPU时钟周期：机器内部主时钟脉冲信号的宽度，是CPU工作的最小时间单位。

   4)主频(CPU时钟频率)：机器内部主时钟的频率，即`时钟周期的倒数`。

   5)CPI：执行一条指令所需要的时钟周期数(CPI是一个平均值)。

   6)IPS：每秒执行的指令数，即`IPS=主频/平均CPI`。

   7)CPU执行时间：运行一个程序所花费的时间，`CPU执行时间=(指令条数×CPI)/主频`。

   8)MIPS：每秒执行多少百万条指令，MIPS=指令条数/(执行时间×10^6^)=主频/(CPI×10^6^)。

   9)FLOPS：每秒钟执行浮点运算次数。

   - MFLOPS：每秒执行多少百万(10^6^)次浮点运算
   - GFLOPS：每秒执行多少十亿(10^8^)次浮点运算
   - TFLOPS：每秒执行多少万亿(10^12^)次浮点运算
   - PFLOPS：每秒执行多少千万亿(10^15^)次浮点运算
   - EFLOPS：每秒执行多少百京(10^18^)次浮点运算
   - ZFLOPS：每秒执行多少十万京(10^21^)次浮点运算

5. 基准程序：用来进行性能评价的一组程序。

### 几个专业术语

1. 系列机：具有基本相同的体系结构，使用相同基本指令系统的多个不`同型号`的计算机组成的一个产品系列。
2. 兼容：指`软件或硬件`的通用性，即运行在某个型号的计算机系统中的软/硬件也能应用于`另一个型号`的计算机系统时，称这两台计算机在硬件或软件上存在兼容性。
3. 固件：将程序固化在ROM中组成的部件。执行速度快于软件，灵活性优于硬件。

### 错题

1. 在用于科学计算的计算机中，标志系统性能的最有用的参数是(  )

   A. 主时钟频率

   B. 主存容量

   C. MFLOPS

   D. MIPS

2. 若一台计算机的机器字长为4B，则表明该机器(  )

   A. 能处理的数值最大为4为十进制数

   B. 能处理的数值最多为4为二进制数

   C. 在CPU中能够作为一个整体处理32位的二进制代码

   D. 在CPU中运算的结果最大为2^32^

3. 在CPU的寄存器中，(  )对用户完全透明。

   A. 程序计数器

   B. 指令寄存器

   C. 状态寄存器

   D. 通用寄存器

4. 计算机中，CPU的CPI与下列(  )因素无关。

   A. 时钟频率

   B. 系统结构

   C. 指令集

   D. 计算机组织

5. 从用户观点看，评价计算机系统性能的综合参数是(  )

   A. 指令系统

   B. 吞吐率

   C. 主存容量

   D. 主频率

6. 当前设计高性能计算机的重要技术途径是(  )

   A. 提高CPU主频

   B. 扩大主存容量

   C. 采用非冯·诺依曼体系结构

   D. 采用并行处理技术

7. 下列关于“兼容”的叙述，正确的是(  )

   A. 指计算机软件与硬件之间的通用性，通常在同一系列不同型号的计算机间存在

   B. 指计算机软件与硬件之间的通用性，即它们在任何计算机间可以通用

   C. 指计算机软件或硬件的通用性，通常在同一系列不同型号的计算机间通用

   D. 指软件在不同系列计算机中可以通用，而硬件不能通用
   
8. 某台计算机只有LOAD/STORE指令能对存储器进行读写操作，其他指令只对寄存器进行操作，根据程序跟踪试验结果，已知每条指令所占的比例以及CPI如下表所示：

   |   指令类型   | 执行所占比例 | CPI  |
   | :----------: | :----------: | :--: |
   | 算术逻辑指令 |     43%      |  1   |
   |   LOAD指令   |     21%      |  2   |
   |  STORE指令   |     12%      |  2   |
   |   转移指令   |     24%      |  2   |

   假设程序由M条指令组成，算术逻辑运算中25%的指令的两个操作数中的一个已存在寄存器中，另一个必须在算术逻辑指令执行前调用LOAD指令从存储器中取到寄存器中。因此增加另一种算术逻辑指令，其特点是一个操作数取自寄存器，另一个操作数取自存储器。假设这种指令的CPI为2，同时转移指令的CPI变为3。求新指令系统的平均CPI。